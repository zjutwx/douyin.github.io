import{c as B,as as x,f as p,aw as b,C as v,ax as S,ay as C,_ as F}from"./common-Cj2DXq7d.js";import{u as T,v as K}from"./other-Dl-hmeYP.js";import"./vendor-EcFAmbRN.js";const I=""+new URL("../assets/water-Cq3Nzf11.png",import.meta.url).href,i=h=>(Vue.pushScopeId("data-v-84e8da8b"),h=h(),Vue.popScopeId(),h),w={class:"Share2Friend"},D=i(()=>Vue.createElementVNode("span",{class:"f16"},"私信给",-1)),O={class:"search"},U={key:0,class:"search-select-friends"},L={class:"wrapper"},R=["src","onClick"],Y={key:1,class:"search-icon",src:S,alt:""},$={key:0,class:"list"},q=["onClick"],z=["src"],H={class:"desc"},M={class:"name"},j={key:0},A={style:{color:"#ffd800"}},G={key:1},J={key:0,class:"account"},P={key:0},Q={style:{color:"#ffd800"}},W={key:1},X={key:1,class:"no-result"},Z=i(()=>Vue.createElementVNode("img",{src:K,alt:""},null,-1)),ee=i(()=>Vue.createElementVNode("span",{class:"n1"},"搜索结果为空",-1)),te=i(()=>Vue.createElementVNode("span",{class:"n2"},"没有搜索到相关的联系人",-1)),ae=[Z,ee,te],le={class:"list"},ne=i(()=>Vue.createElementVNode("span",null,"已加入的群聊",-1)),se=i(()=>Vue.createElementVNode("div",{class:"title"},"最近聊天",-1)),oe=["onClick"],ce=["src"],re=i(()=>Vue.createElementVNode("div",{class:"title"},"互关好友",-1)),de=["onClick"],ie=["src"],ue=i(()=>Vue.createElementVNode("div",{class:"title"},"全部",-1)),Ve=["onClick"],me=["src"],pe={key:0,class:"share2friend"},ve=i(()=>Vue.createElementVNode("div",{class:"comment"},[Vue.createElementVNode("textarea",{placeholder:"有什么想和好友说的..."}),Vue.createElementVNode("img",{class:"poster",src:C,alt:""})],-1)),he={class:"wrapper"},_e={key:0,class:"create-chat"},fe=i(()=>Vue.createElementVNode("span",null,"创建群聊",-1)),ke=Vue.createStaticVNode('<div class="indicator-ctn" data-v-84e8da8b><div class="indicator" data-v-84e8da8b><div class="item" data-index="top" data-v-84e8da8b>#</div><div class="item" data-v-84e8da8b>A</div><div class="item" data-v-84e8da8b>B</div><div class="item" data-v-84e8da8b>C</div><div class="item" data-v-84e8da8b>D</div><div class="item" data-v-84e8da8b>E</div><div class="item" data-v-84e8da8b>F</div><div class="item" data-v-84e8da8b>G</div><div class="item" data-v-84e8da8b>H</div><div class="item" data-v-84e8da8b>I</div><div class="item" data-v-84e8da8b>J</div><div class="item" data-v-84e8da8b>K</div><div class="item" data-v-84e8da8b>L</div><div class="item" data-v-84e8da8b>M</div><div class="item" data-v-84e8da8b>N</div><div class="item" data-v-84e8da8b>O</div><div class="item" data-v-84e8da8b>P</div><div class="item" data-v-84e8da8b>Q</div><div class="item" data-v-84e8da8b>R</div><div class="item" data-v-84e8da8b>S</div><div class="item" data-v-84e8da8b>T</div><div class="item" data-v-84e8da8b>U</div><div class="item" data-v-84e8da8b>V</div><div class="item" data-v-84e8da8b>W</div><div class="item" data-v-84e8da8b>X</div><div class="item" data-v-84e8da8b>Y</div><div class="item" data-v-84e8da8b>Z</div></div></div>',1),ye=i(()=>Vue.createElementVNode("img",{src:I,alt:""},null,-1)),ge=Vue.defineComponent({name:"Share2Friend",__name:"Share2Friend",setup(h){const f=T(),e=Vue.reactive({isCreateChat:!1,searchKey:"",indexOffsetTop:{},currentFixedIndicator:"",currentFixedIndicatorTop:"0px",friends:{all:{},recent:[],eachOther:[]},selectFriends:[],friendsSort:{},searchResult:[]});Vue.onMounted(()=>{g(),document.querySelectorAll(".index").forEach(r=>{e.indexOffsetTop[r.children[0].innerText]=r.offsetTop});let a=document.querySelectorAll(".item"),d=document.querySelector(".item:nth-child(2)").clientHeight,s=document.querySelector(".indicator"),t=s.offsetTop,o="rgb(143, 143, 158)";s.addEventListener("touchstart",r=>{let u=(r.touches[0].pageY-t)/d;u=Math.floor(u),n(u),e.currentFixedIndicatorTop=r.touches[0].pageY-28+"px"}),s.addEventListener("touchmove",r=>{let V=r.touches[0].pageY-t;e.currentFixedIndicatorTop=r.touches[0].pageY-28+"px";let u=V/d;u=Math.floor(u),u>=0&&u<27&&n(u)}),s.addEventListener("touchend",()=>e.currentFixedIndicator="");let n=r=>{a.forEach(V=>{V.style.color=o}),a[r].style.color="#fff",e.currentFixedIndicator=a[r].innerText,E(a[r])}}),Vue.watch(()=>e.searchKey,l=>{let a=B(e.friends.all);a.map(c=>{e.selectFriends.find(d=>d.id===c.id)&&(c.select=!0)}),e.searchResult=a.filter(c=>c.name.includes(l)||c.account.includes(l))});function k(l){m(l),e.searchKey=""}function y(){console.log("clear"),e.searchKey=""}function m(l){for(let s=0;s<e.friends.recent.length;s++){let t=e.friends.recent[s];if(t.name===l.name){t.select=!t.select;break}}for(let s=0;s<e.friends.eachOther.length;s++){let t=e.friends.eachOther[s];if(t.name===l.name){t.select=!t.select;break}}let a=!1,c=Object.keys(e.friendsSort);for(let s=0;s<c.length;s++){let t=c[s];for(let o=0;o<e.friendsSort[t].length;o++){let n=e.friendsSort[t][o];if(n.name===l.name){n.select=!n.select,a=!0;break}}if(a)break}let d=e.selectFriends.findIndex(s=>s.name===l.name);d!==-1?(l.select=!1,e.selectFriends.splice(d,1)):(l.select=!0,e.selectFriends.push(l))}async function g(){let l=await x();console.log("getFriends",l),l.success&&(e.friends=l.data,e.friends.all=e.friends.all.sort((a,c)=>a.pinyin<c.pinyin?-1:a.pinyin>c.pinyin?1:0),e.friends.all.map(a=>{e.friendsSort[a.pinyin]?e.friendsSort[a.pinyin].push(a):e.friendsSort[a.pinyin]=[a]}))}const _=Vue.ref();function E(l){let a;l.dataset.index?a="top":a=l.innerText,document.querySelector(`.${a}`)&&(_.value.scrollTop=document.querySelector(`.${a}`).offsetTop-100)}function N(l){let a=l.target.scrollTop+110,c=null;for(const d in e.indexOffsetTop)e.indexOffsetTop[d]<a&&(c=d);e.currentFixedIndicator=c}return(l,a)=>{const c=Vue.resolveComponent("BaseHeader"),d=Vue.resolveComponent("dy-back"),s=Vue.resolveComponent("dy-button");return Vue.openBlock(),Vue.createElementBlock("div",w,[Vue.createVNode(c,{backImg:"close",style:{"z-index":"7"}},{center:Vue.withCtx(()=>[D]),bottom:Vue.withCtx(()=>[Vue.createElementVNode("div",O,[e.selectFriends.length?(Vue.openBlock(),Vue.createElementBlock("div",U,[Vue.createElementVNode("div",L,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(e.selectFriends,(t,o)=>(Vue.openBlock(),Vue.createElementBlock("img",{src:Vue.unref(p)(t.avatar),key:o,onClick:n=>m(t)},null,8,R))),128))])])):(Vue.openBlock(),Vue.createElementBlock("img",Y)),Vue.withDirectives(Vue.createElementVNode("input",{type:"text",placeholder:"搜索","onUpdate:modelValue":a[0]||(a[0]=t=>e.searchKey=t)},null,512),[[Vue.vModelText,e.searchKey]]),e.searchKey?(Vue.openBlock(),Vue.createElementBlock("img",{key:2,onClick:y,class:"clear",src:b})):Vue.createCommentVNode("",!0)])]),_:1}),Vue.withDirectives(Vue.createElementVNode("div",{class:"is-search",style:Vue.normalizeStyle({height:e.selectFriends.length&&e.searchResult.length?"calc(100% - 272rem)":"calc(100% - 112rem)"})},[e.searchResult.length?(Vue.openBlock(),Vue.createElementBlock("div",$,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(e.searchResult,(t,o)=>(Vue.openBlock(),Vue.createElementBlock("div",{class:"local-row",key:o,onClick:n=>k(t)},[Vue.createVNode(v,{mode:"red",modelValue:t.select,"onUpdate:modelValue":n=>t.select=n},null,8,["modelValue","onUpdate:modelValue"]),Vue.createElementVNode("img",{src:Vue.unref(p)(t.avatar),alt:""},null,8,z),Vue.createElementVNode("div",H,[Vue.createElementVNode("span",M,[t.name.indexOf(e.searchKey)>-1?(Vue.openBlock(),Vue.createElementBlock("span",j,[Vue.createTextVNode(Vue.toDisplayString(t.name.substr(0,t.name.indexOf(e.searchKey))),1),Vue.createElementVNode("span",A,Vue.toDisplayString(e.searchKey),1),Vue.createTextVNode(Vue.toDisplayString(t.name.substr(t.name.indexOf(e.searchKey)+e.searchKey.length)),1)])):(Vue.openBlock(),Vue.createElementBlock("span",G,Vue.toDisplayString(t.name),1))]),t.account?(Vue.openBlock(),Vue.createElementBlock("span",J,[Vue.createTextVNode(" 抖音号： "),t.account.indexOf(e.searchKey)>-1?(Vue.openBlock(),Vue.createElementBlock("span",P,[Vue.createTextVNode(Vue.toDisplayString(t.account.substr(0,t.account.indexOf(e.searchKey))),1),Vue.createElementVNode("span",Q,Vue.toDisplayString(e.searchKey),1),Vue.createTextVNode(Vue.toDisplayString(t.account.substr(t.account.indexOf(e.searchKey)+e.searchKey.length)),1)])):(Vue.openBlock(),Vue.createElementBlock("span",W,Vue.toDisplayString(t.account),1))])):Vue.createCommentVNode("",!0)])],8,q))),128))])):(Vue.openBlock(),Vue.createElementBlock("div",X,ae))],4),[[Vue.vShow,e.searchKey]]),Vue.createElementVNode("div",{ref_key:"list",ref:_,style:Vue.normalizeStyle({paddingBottom:e.selectFriends.length?"160rem":0}),class:"content",onScroll:N},[Vue.createElementVNode("div",le,[Vue.createElementVNode("div",{class:"row",onClick:a[1]||(a[1]=t=>Vue.unref(f)("/message/joined-group-chat"))},[ne,Vue.createVNode(d,{scale:.7,direction:"right"})]),se,(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(e.friends.recent,(t,o)=>(Vue.openBlock(),Vue.createElementBlock("div",{class:"local-row",key:o,onClick:n=>m(t)},[Vue.createVNode(v,{mode:"red",modelValue:t.select,"onUpdate:modelValue":n=>t.select=n},null,8,["modelValue","onUpdate:modelValue"]),Vue.createElementVNode("img",{src:Vue.unref(p)(t.avatar),alt:""},null,8,ce),Vue.createElementVNode("span",null,Vue.toDisplayString(t.name),1)],8,oe))),128)),re,(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(e.friends.eachOther,(t,o)=>(Vue.openBlock(),Vue.createElementBlock("div",{class:"local-row",key:o,onClick:n=>m(t)},[Vue.createVNode(v,{mode:"red",modelValue:t.select,"onUpdate:modelValue":n=>t.select=n},null,8,["modelValue","onUpdate:modelValue"]),Vue.createElementVNode("img",{src:Vue.unref(p)(t.avatar),alt:""},null,8,ie),Vue.createElementVNode("span",null,Vue.toDisplayString(t.name),1)],8,de))),128)),ue,(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(e.friendsSort,(t,o)=>(Vue.openBlock(),Vue.createElementBlock("div",{key:o},[Vue.createElementVNode("div",{class:Vue.normalizeClass([o==="#"?"top":o,"title"])},[Vue.createElementVNode("span",null,Vue.toDisplayString(o),1)],2),(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(t,(n,r)=>(Vue.openBlock(),Vue.createElementBlock("div",{class:"local-row",key:r,onClick:V=>m(n)},[Vue.createVNode(v,{mode:"red",modelValue:n.select,"onUpdate:modelValue":V=>n.select=V},null,8,["modelValue","onUpdate:modelValue"]),Vue.createElementVNode("img",{src:Vue.unref(p)(n.avatar),alt:""},null,8,me),Vue.createElementVNode("span",null,Vue.toDisplayString(n.name),1)],8,Ve))),128))]))),128))]),e.selectFriends.length&&e.searchResult.length?(Vue.openBlock(),Vue.createElementBlock("div",pe,[ve,Vue.createElementVNode("div",he,[e.selectFriends.length>1?(Vue.openBlock(),Vue.createElementBlock("div",_e,[Vue.createVNode(v,{mode:"red",modelValue:e.isCreateChat,"onUpdate:modelValue":a[2]||(a[2]=t=>e.isCreateChat=t)},null,8,["modelValue"]),fe])):Vue.createCommentVNode("",!0),Vue.createVNode(s,{type:"primary"},{default:Vue.withCtx(()=>[Vue.createTextVNode(Vue.toDisplayString(e.selectFriends.length>1?"分别发送":"发送"),1)]),_:1})])])):Vue.createCommentVNode("",!0)],36),ke,e.currentFixedIndicator?(Vue.openBlock(),Vue.createElementBlock("div",{key:0,class:"hover",style:Vue.normalizeStyle({top:e.currentFixedIndicatorTop}),ref:"hover"},[ye,Vue.createElementVNode("span",null,Vue.toDisplayString(e.currentFixedIndicator),1)],4)):Vue.createCommentVNode("",!0)])}}}),xe=F(ge,[["__scopeId","data-v-84e8da8b"]]);export{xe as default};
